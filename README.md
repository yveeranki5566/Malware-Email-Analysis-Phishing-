  # Malware-Email-Analysis-Phishing

  Phishing email analysis involves verifying the sender's authenticity, scrutinizing the content for red flags, and inspecting links and attachments for malicious intent. This process helps in identifying and mitigating potential phishing threats.

  In this project, an email with potential malware is downloaded and analyzed using notepad++, HxD, exiftool and used websites such as Gary Kessler File Signatures, and Cyberchef.

  1. Let's open the malicious email in a windows VM using notepad++ to look at the details.

  ![image](https://github.com/user-attachments/assets/b111c4aa-6024-4577-a8b2-adc943a418d6)

  # List of fields that were found suspicious.
  

1. The from email address and reply-to email addresses are different.
   

![image](https://github.com/user-attachments/assets/bbbafdeb-4004-44b9-a953-5c2e20475266)



2. We can see that the SPF(Security Policy Framework) is set to False, which means that the email's sending server is not authorized by the domain's SPF record, indicating potential spoofing or unauthorized use of the email domain. This usually suggests that the email might be fraudulent or not from a legitimate source.
   

![image](https://github.com/user-attachments/assets/04207c58-f835-4d94-a886-21604408432d)


3. Lets check the email service if it is fake or not.


![image](https://github.com/user-attachments/assets/fa276c03-ad71-4f4c-abb8-82a91b09264e)

![image](https://github.com/user-attachments/assets/c0a7cfc6-1cc7-4364-b0d1-2a5c2e367fba)

4. Its fake, lets go and check the contents of the email.

![image](https://github.com/user-attachments/assets/79bb250d-3f20-4967-a0db-9f99c483267c)

content-type:text/plain 

Lets copy and paste the file data in cyber chef input field and use from base 64 operator to convert.

![image](https://github.com/user-attachments/assets/c8ee114b-423b-4e88-b50d-a092c45f4e2b)

Now save the output to a text file and it was converted as below.

![image](https://github.com/user-attachments/assets/d575c100-6349-4f93-9aec-adac8377f72e)

5. Lets copy the file data from the next boundary and check in cyber chef tool using base 64 operator.

![image](https://github.com/user-attachments/assets/19b1dcac-f333-48a2-94a8-ee55e085bd1a)

The first few bytes of the file makes the file signature so lets convert the data using To Hex operator and observe the output.

![image](https://github.com/user-attachments/assets/715ca498-be50-4613-8b31-03805c115e60)

From the below image we can see that the file is a pdf file.

![image](https://github.com/user-attachments/assets/4dcc5234-11a5-4d29-b08a-b049455c3789)

But lets check if it is actually a pdf file or not using Gary Kessler file signatures table.

![image](https://github.com/user-attachments/assets/56c4e95a-4de8-4280-b481-71318ae5e540)

Its actually as .zip file , so lets go ahead and save the output from cyber chef tool as .zip file.

6. Extract the .zip file and make sure to check the hidden files to view all files.

![image](https://github.com/user-attachments/assets/70b2e9ca-9554-4bc5-8781-3024671e3511)

7. check the file extensions of these files using HxD tool and Gary Kessler file signatures table.

![image](https://github.com/user-attachments/assets/03ad9632-1df7-4aa2-b2c8-6fe3410bd48d)

The first file is a jpeg file so lets rename with jpeg extension.

![image](https://github.com/user-attachments/assets/c2d18cac-2617-4f88-a3ea-94e9ee70737e)

check the second file and follow the same process.

![image](https://github.com/user-attachments/assets/7a3c3012-fba0-41a9-9d49-859f829dd7a8)

It is a PDF file.

![image](https://github.com/user-attachments/assets/452d21d0-40a0-4481-a6d8-bd715c5daa44)


![image](https://github.com/user-attachments/assets/013fca9d-65b3-48e4-a21d-572ce9cee3cc)

Open the PDF file and we see the below content inside it.

![image](https://github.com/user-attachments/assets/4e8ed367-6c4d-4c24-9cb8-9ef26edaa102)

Now lets open the excel file and check for any suspicious data can be found for further investigation.

![image](https://github.com/user-attachments/assets/75eb0e0a-7b4a-4c0d-bfdf-89cba97c14d8)

There are two sheets in the excel , lets check if any data is hidden by clearing the format in both the sheets.

In the second sheet we see the below hidden data.

![image](https://github.com/user-attachments/assets/f78ca614-bc80-4989-99cd-538611c1e3d5)

Lets go and get the data converted using cyberchef tool by using from base 64 operator.

![image](https://github.com/user-attachments/assets/661e514b-af64-493d-8200-c26090170071)

It gives us the location of the attacker.

8. With the help of exiftool lets find the meta data of the files to check if we can find the name of the attacker.

![image](https://github.com/user-attachments/assets/da4ab2e1-1361-4c3a-ab1f-702208557738)

It is Pestero Negeja , which we can see under author section.

## So now we know the content inside this suspicious email, name and location of the attacker. 
























  
